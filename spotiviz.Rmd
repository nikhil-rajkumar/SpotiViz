---
title: "SpotiViz"
author: "Nikhil Rajkumar & Meghana Jaladanki"
date: "4/20/2021"
output: html_document
---

```{r, echo=FALSE}
library(ggplot2)
```

## SpotiViz

We intend on using a Spotify dataset to produce effective visualizations that answer a specific set of questions. Our dataset consists of song information and it consists of a bunch of musical attributes along with a track name. We have immense data to locate trends and how music has progressed over time. With attributes ranging from liveness, popularity, danceability, speechiness, energy, etc.

```{r}
df.spotify <- read.csv("data.csv")
df.spotify$explicit <- as.factor(df.spotify$explicit)
df.spotify$duration_ms <- (df.spotify$duration_ms/1000)
summary(df.spotify)
```

## Trends

# 1. How does popularity of a song vary over time?

```{r}
pop.plot <- ggplot(data=df.spotify , aes(x=year, y=popularity)) + 
    geom_point(color = "#1DB954", size = 1) +
    ggtitle("Popularity of Music over time") +
    xlab("Year") + 
    ylab("Popularity")
pop.plot


#Time Series -> 
```


This plot explains how newer songs are more popular among Spotify users. This could be explained by how majority of its users (55%) are within the age range of 18-34 and are more likely exposed to newer music and hence the higher popularity. 


# 2. How has energy and danceability of a song varied over time?  -> Remove if needed: No trend observed

```{r}
dance.plot <- ggplot(data=df.spotify , aes(x=year, y=danceability)) + 
    geom_point(color = "#1DB954", size = 1) +
    ggtitle("Danceability of Music over time") +
    xlab("Year") + 
    ylab("Danceability")
dance.plot
```


# 3. How has the popularity of explicit language songs changed over time?

```{r}
##1DB954
##00AFBB
exp.plot <- ggplot(data=df.spotify , aes(x=year, y=explicit)) + 
    geom_boxplot(color = "#56B4E9", size = 1) +
    ggtitle("Explicit Music over time") +
    xlab("Year") + 
    ylab("Explicit")
exp.plot
```
1 represents if a song containts explicit language while 0 conveys that it does not have explicit language. According to the boxplot above, we notice that most of the songs without explicit langauge were released between the late 1950s and late 1990s. However, most of the songs with explicit language were released between the Late 1980s and present day. 
This could potentially be explained by how society has become more open-minded and progressive over time by being more acceptive of artists expressing themselves in music and how they really feel (Hence, the explicit language). 

# 4. How has the duration of a song changed over time?   -> Remove maybe: no significant trend

```{r}
dur.plot <- ggplot(data=df.spotify , aes(x=year, y=duration_ms)) + 
    geom_point(color = "#1DB954", size = 1) +
    ggtitle("Duration of Music over time") +
    xlab("Year") + 
    ylab("Duration")
dur.plot
```



# 5. Number of features over time
```{r}
v <- list()

for (i in 1:length(df.spotify$artists)){
    v[i] <- length(strsplit(df.spotify$artists[i], ",")[[1]])
}

df.spotify$art <- v

feat.plot <- ggplot(data=df.spotify , aes(x=year, y=as.numeric(art))) + 
    geom_point(color = "#1DB954", size = 1) +
    ggtitle("Number of Features over time") +
    xlab("Year") + 
    ylab("Number of Features")
feat.plot
```


# 6. Liveliness v Popularity
```{r}
liv.plot <- ggplot(data=df.spotify , aes(x=liveness, y=popularity)) + 
    geom_point(color = "#1DB954", size = 1) +
    ggtitle("Liveness v Popularity") +
    xlab("Liveness") + 
    ylab("Popularity") +
    geom_smooth(method=lm)
liv.plot
```

> A good number of popular songs are less livlier. 

# 7. Danceability v Popularity 
```{r}
dnce.plot <- ggplot(data=df.spotify , aes(x=danceability, y=popularity)) + 
    geom_point(color = "#1DB954", size = 1) +
    ggtitle("Danceability v Popularity") +
    xlab("Danceability") + 
    ylab("Popularity") + 
    geom_smooth(method=lm)
dnce.plot
```
> There is a small trend showing us that more danceable tracks are more popular.



## Links to data sources

> https://www.kaggle.com/yamaerenay/spotify-dataset-19212020-160k-tracks 

## Links to extra resources

> https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf



## TIME SERIES STUFF -> Remove if not working

```{r}
spotify.ts1 <- ts(data = df.spotify, start = c(1921), frequency = 1)
```

```{r}
d.ts <- ts(data=df.spotify$duration_ms, frequency =1)
plot.ts(d.ts)
```

```{r}
p.ts <- ts(data=df.spotify$popularity, frequency =12)
plot.ts(p.ts)
```



